<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configurateur APC3D 2025</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
      margin: 20px;
    }
    .config-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    .config-line {
      background: white;
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      margin-bottom: 20px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .config-block {
      flex: 1 1 22%;
      min-width: 220px;
      margin: 10px;
    }
    .config-block h4 {
      margin-bottom: 10px;
    }
    .actions {
      text-align: center;
      margin-top: 30px;
    }
    .btn {
      display: inline-block;
      padding: 12px 24px;
      margin: 10px;
      background-color: #ff6600;
      color: white;
      border: none;
      border-radius: 5px;
      text-decoration: none;
      cursor: pointer;
      font-weight: bold;
    }
    .btn:hover {
      background-color: #e65c00;
    }
    .options {
      margin-top: 10px;
    }
    label {
      display: block;
      margin: 5px 0 2px;
    }
    input, select {
      width: 100%;
      padding: 6px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .checkbox-container {
      margin-top: 10px;
    }
    @media (max-width: 768px) {
      .config-line {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<div class="config-container" id="config-container">

  <!-- Zone d'import fichiers -->
  <div class="actions">
    <input type="file" id="fileInput" multiple accept=".stl,.step">
    <div class="options">
      <a href="#" class="btn" onclick="addFile()">Ajouter un fichier 3D</a>
    </div>
  </div>

  <!-- Les lignes de configuration apparaîtront ici -->

</div>

<!-- Boutons finaux -->
<div class="actions">
  <a href="#" class="btn">Négocier vos tarifs</a>
  <a href="#" class="btn">Générer un devis</a>
  <a href="#" class="btn">Commander maintenant</a>
</div>

<script>
function addFile() {
  const input = document.getElementById('fileInput');
  if (input.files.length === 0) {
    alert("Merci de choisir un fichier STL ou STEP.");
    return;
  }

  Array.from(input.files).forEach(file => {
    const container = document.getElementById('config-container');

    const configLine = document.createElement('div');
    configLine.className = 'config-line';

    // Bloc 1 : Aperçu 3D
    const block1 = document.createElement('div');
    block1.className = 'config-block';
    block1.innerHTML = `<h4>Aperçu 3D</h4>
      <model-viewer src="" alt="Aperçu" style="width:100%; height:200px;" camera-controls></model-viewer>`;
    configLine.appendChild(block1);

    // Charger le fichier localement dans model-viewer
    const modelViewer = block1.querySelector('model-viewer');
    const reader = new FileReader();
    reader.onload = function(e) {
      modelViewer.src = e.target.result;
    }
    reader.readAsDataURL(file);

    // Bloc 2 : Configuration
    const block2 = document.createElement('div');
    block2.className = 'config-block';
    block2.innerHTML = `<h4>Configuration</h4>
      <label>Technologie</label>
      <select>
        <option>SLS</option>
        <option>FDM</option>
        <option>MSLA</option>
      </select>
      <label>Matériau</label>
      <select>
        <option>PA12</option>
        <option>ABS</option>
        <option>Résine standard</option>
      </select>
      <label>Finition</label>
      <select>
        <option>Brut</option>
        <option>Coloré</option>
        <option>Peint</option>
      </select>`;
    configLine.appendChild(block2);

    // Bloc 3 : Quantité et prix
    const block3 = document.createElement('div');
    block3.className = 'config-block';
    block3.innerHTML = `<h4>Quantité & Prix</h4>
      <label>Quantité prédéfinie</label>
      <select>
        <option>1</option>
        <option>2</option>
        <option>4</option>
        <option>8</option>
        <option>16</option>
        <option>32</option>
      </select>
      <label>Quantité personnalisée</label>
      <input type="number" min="1" placeholder="Quantité personnalisée">
      <p><strong>Prix estimé : xx €</strong></p>`;
    configLine.appendChild(block3);

    // Bloc 4 : Livraison & Options
    const block4 = document.createElement('div');
    block4.className = 'config-block';
    block4.innerHTML = `<h4>Livraison & Options</h4>
      <label>Délai de livraison</label>
      <select>
        <option>Standard (7j)</option>
        <option>Express (48h)</option>
      </select>
      <div class="checkbox-container">
        <input type="checkbox" id="optionInsert${Math.random()}" name="insert">
        <label for="optionInsert">Inserts/Taraudages</label>
        <input type="checkbox" id="optionColor${Math.random()}" name="color">
        <label for="optionColor">Peinture / Couleur</label>
        <input type="checkbox" checked>
        <label>Inclure cette pièce dans la commande</label>
      </div>`;
    configLine.appendChild(block4);

    container.appendChild(configLine);
  });

  // Clear files après ajout
  input.value = '';
}
</script>

</body>
</html>
